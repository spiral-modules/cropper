{"version":3,"sources":["sf.crop.js"],"names":["root","factory","exports","module","require","define","amd","a","i","this","__WEBPACK_EXTERNAL_MODULE_2__","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","_interopRequireDefault","obj","__esModule","default","_sf","_sf2","_crop","_crop2","instancesController","registerInstanceType","Object","defineProperty","value","undefined","_create","_create2","externals","template","Crop","sf","node","options","_construct","prototype","core","BaseDOMConstructor","name","init","that","noop","parser","DOMParser","tools","extend","showInfo","split","aspectRatio","parseFloat","onFileProcessed","els","input","tagName","getElementsByClassName","modal","parseFromString","firstChild","lastChild","previewSelector","preview","document","querySelector","console","warn","adjustSelector","adjust","ajaximage","cropWrapper","imageOriginal","cropElements","cropSave","closePopup","cropInfo","ratio","croppedSize","origSize","handlers","n","ne","e","se","s","sw","w","nw","current","dimmers","el","form","getInstance","reset","addEventListeners","attachData","parentNode","removeChild","xhr","XMLHttpRequest","onreadystatechange","readyState","status","img","Image","url","window","URL","webkitURL","response","Blob","src","createObjectURL","handleFileSelect","open","responseType","send","navigator","appVersion","indexOf","style","backgroundColor","optionsToGrab","sendFormat","domAttr","ajaxAddress","cnv","cursor","x","y","crop","x2","y2","h","toSave","image","old","start","canvas","orig","scale","setTop","setLeft","setWidth","setHeight","changeInfo","type","innerHTML","updateInfo","length","forEach","info","Math","round","showPopup","body","appendChild","addModalEventListeners","removeEventListeners","hidePopup","removeModalEventListeners","_inputChange","file","target","files","match","display","alert","_openCropper","readyToPrepare","prepare","addEventListener","removeEventListener","_cropSave","save","_hidePopup","_cropWrapperMouseDown","onCropStart","inCropping","_documentMouseMove","preventDefault","onCrop","_cropWrapperMouseUp","onCropEnd","_documentMouseUp","setPreviewImage","newimg","cloneNode","maxWidth","reader","FileReader","onload","theFile","blob","encodeURIComponent","replace","base64","result","clientHeight","clientWidth","naturalHeight","naturalWidth","readAsDataURL","drawImageOnCanvas","ctx","drawImage","setTimeout","createElement","width","height","getContext","offset","getBoundingClientRect","clientX","left","clientY","top","offsetX","layerX","offsetY","layerY","setN","setNE","setE","setSE","setS","setSW","setW","setNW","move","adjustN","notDefaultSide","adjustS","adjustW","adjustE","abs","setDimmers","dataURItoBlob","dataURI","byteString","mimeString","content","atob","decodeURI","charCodeAt","Uint8Array","strDataURI","toDataURL","events","on","data","append","die","$","P","D","create","$Object","getProto","getPrototypeOf","isEnum","propertyIsEnumerable","getDesc","getOwnPropertyDescriptor","setDesc","setDescs","defineProperties","getKeys","keys","getNames","getOwnPropertyNames","getSymbols","getOwnPropertySymbols","each","locals","push","list","toString","item","join","mediaQuery","alreadyImportedModules","addStylesToDom","styles","domStyle","stylesInDom","refs","j","parts","addStyle","listToStyles","newStyles","css","media","sourceMap","part","insertStyleElement","styleElement","head","getHeadElement","lastStyleElementInsertedAtTop","styleElementsInsertedAtTop","insertAt","nextSibling","insertBefore","Error","removeStyleElement","idx","splice","createStyleElement","createLinkElement","linkElement","rel","update","remove","singleton","styleIndex","singletonCounter","singletonElement","applyToSingletonTag","bind","revokeObjectURL","btoa","updateLink","href","applyToTag","newObj","index","styleSheet","cssText","replaceText","cssNode","createTextNode","childNodes","setAttribute","unescape","JSON","stringify","oldSrc","memoize","fn","memo","apply","arguments","isOldIE","test","userAgent","toLowerCase","getElementsByTagName","newList","mayRemove","textStore","replacement","filter","Boolean"],"mappings":"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","file":"sf.crop.min.js","sourcesContent":["/*! Spiral Image Cropper Widget v0.4.0\n *  https://github.com/spiral-modules/image-cropper/\n *  Copyright (c) 2016, Alex Chepura, Yauheni Yasinau, spiralscout.com\n */\n\n(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"sf\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"sf\"], factory);\n\telse {\n\t\tvar a = typeof exports === 'object' ? factory(require(\"sf\")) : factory(root[\"sf\"]);\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(this, function(__WEBPACK_EXTERNAL_MODULE_2__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n\n\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__(1);\n\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\n\tvar _sf = __webpack_require__(2);\n\n\tvar _sf2 = _interopRequireDefault(_sf);\n\n\tvar _crop = __webpack_require__(3);\n\n\tvar _crop2 = _interopRequireDefault(_crop);\n\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n\t__webpack_require__(8); //resolved in webpack's \"externals\"\n\n\t_sf2.default.instancesController.registerInstanceType(_crop2.default, \"js-sf-crop\");\n\tmodule.exports = _crop2.default; // ES6 default export will not expose us as global\n\n/***/ },\n/* 2 */\n/***/ function(module, exports) {\n\n\tmodule.exports = __WEBPACK_EXTERNAL_MODULE_2__;\n\n/***/ },\n/* 3 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.default = undefined;\n\n\tvar _create = __webpack_require__(4);\n\n\tvar _create2 = _interopRequireDefault(_create);\n\n\tvar _sf = __webpack_require__(2);\n\n\tvar _sf2 = _interopRequireDefault(_sf);\n\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n\t//resolved in webpack's \"externals\"\n\n\tvar externals = {\n\t    template: __webpack_require__(7)\n\t};\n\tvar Crop = function Crop(sf, node, options) {\n\t    this._construct(sf, node, options);\n\t};\n\n\t/**\r\n\t * @lends sf.Form.prototype\r\n\t */\n\tCrop.prototype = (0, _create2.default)(_sf2.default.modules.core.BaseDOMConstructor.prototype);\n\n\t/**\r\n\t * Name to register\r\n\t * @type {string}\r\n\t */\n\tCrop.prototype.name = \"crop\";\n\n\tCrop.prototype._construct = function (sf, node, options) {\n\n\t    this.init(sf, node, options); //call parent\n\n\t    this.options.template = this.options.template || externals.template;\n\n\t    var that = this,\n\t        noop = function noop() {},\n\t        parser = new DOMParser();\n\n\t    if (options) {\n\t        //if we pass options extend all options by passed options\n\t        this.options = sf.tools.extend(this.options, options);\n\t    }\n\n\t    if (typeof this.options.showInfo == \"string\") this.options.showInfo = this.options.showInfo.split(\",\");\n\n\t    if (this.options.aspectRatio) this.options.aspectRatio = parseFloat(this.options.aspectRatio); //just to be sure about number format, not string\n\t    if (typeof this.options.onFileProcessed != \"function\") this.options.onFileProcessed = noop;\n\n\t    //elements\n\t    this.els = {\n\t        node: node,\n\t        input: node.tagName === \"INPUT\" ? node : node.getElementsByClassName(\"sf-crop-input\")[0],\n\t        modal: parser.parseFromString(this.options.template, \"text/html\").firstChild.lastChild.firstChild\n\t    };\n\n\t    if (this.options.previewSelector) {\n\t        this.els.preview = document.querySelector(this.options.previewSelector);\n\t    } else {\n\t        console.warn('Provide image-preview selector with data-previewSelector');\n\t    }\n\t    if (this.options.adjustSelector) {\n\t        this.els.adjust = document.querySelector(this.options.adjustSelector);\n\t    } else {\n\t        console.warn('Provide adjust-crop selector with data-adjustSelector');\n\t    }\n\n\t    if (!this.options.ajaximage && !this.els.input) {\n\t        console.warn('Provide file-input to use cropper or load image with ajax (with data-ajaximage attr)');\n\t    }\n\t    this.els.cropWrapper = this.els.modal.getElementsByClassName(\"sf-crop-wrapper\")[0];\n\t    this.els.imageOriginal = this.els.modal.getElementsByClassName(\"sf-crop-image-original\")[0];\n\t    this.els.cropElements = this.els.modal.getElementsByClassName(\"sf-crop-elements\")[0];\n\t    this.els.cropSave = this.els.modal.getElementsByClassName(\"sf-crop-save\")[0];\n\t    this.els.closePopup = this.els.modal.getElementsByClassName(\"sf-crop-close\")[0];\n\n\t    this.els.cropInfo = {\n\t        ratio: this.els.modal.getElementsByClassName(\"sf-crop-ratio\")[0],\n\t        croppedSize: this.els.modal.getElementsByClassName(\"sf-crop-cropped-size\")[0],\n\t        origSize: this.els.modal.getElementsByClassName(\"sf-crop-orig-size\")[0]\n\t    };\n\n\t    this.els.handlers = {\n\t        n: this.els.modal.getElementsByClassName(\"handler-N\")[0],\n\t        ne: this.els.modal.getElementsByClassName(\"handler-NE\")[0],\n\t        e: this.els.modal.getElementsByClassName(\"handler-E\")[0],\n\t        se: this.els.modal.getElementsByClassName(\"handler-SE\")[0],\n\t        s: this.els.modal.getElementsByClassName(\"handler-S\")[0],\n\t        sw: this.els.modal.getElementsByClassName(\"handler-SW\")[0],\n\t        w: this.els.modal.getElementsByClassName(\"handler-W\")[0],\n\t        nw: this.els.modal.getElementsByClassName(\"handler-NW\")[0],\n\t        current: null\n\t    };\n\n\t    this.els.dimmers = {\n\t        el: this.els.modal.getElementsByClassName(\"dimmers\")[0],\n\t        n: this.els.modal.getElementsByClassName(\"dimmer-N\")[0],\n\t        e: this.els.modal.getElementsByClassName(\"dimmer-E\")[0],\n\t        s: this.els.modal.getElementsByClassName(\"dimmer-S\")[0],\n\t        w: this.els.modal.getElementsByClassName(\"dimmer-W\")[0]\n\t    };\n\n\t    this.els.form = this.els.input ? this.els.input.form : '';\n\t    this.form = sf.instancesController.getInstance(\"form\", this.els.form);\n\n\t    this.reset();\n\t    this.addEventListeners();\n\t    this.attachData();\n\n\t    if (this.options.ajaximage) {\n\t        if (this.els.input && this.els.input !== this.els.node) this.els.input.parentNode.removeChild(this.els.input); //this check is for not to remove cropper's node and not to trigger die method\n\t        var xhr = new XMLHttpRequest();\n\t        xhr.onreadystatechange = function () {\n\t            if (this.readyState == 4 && this.status == 200) {\n\t                var img = new Image();\n\t                var url = window.URL || window.webkitURL;\n\t                if (this.response instanceof Blob) {\n\t                    img.src = url.createObjectURL(this.response);\n\t                    that.handleFileSelect(this.response);\n\t                    //that.els.adjust.style.display = 'inline-block';\n\t                } else {\n\t                        that.els.adjust.parentNode.removeChild(that.els.adjust);\n\t                    }\n\t            }\n\t        };\n\t        xhr.open('GET', that.options.ajaximage);\n\t        xhr.responseType = 'blob';\n\t        xhr.send();\n\t    }\n\t    //IE10 click to move doesn't work. looks like click goes through cropper to background picture =(\n\t    if (navigator.appVersion.indexOf(\"MSIE 10\") != -1) this.els.cropElements.style.backgroundColor = \"rgba(255,255,255,0.01\";\n\t};\n\n\t/**\r\n\t * @override\r\n\t * @inheritDoc\r\n\t * @enum {string}\r\n\t */\n\tCrop.prototype.optionsToGrab = {\n\t    /**\r\n\t     *  How to send: cropped or full size with coordinates to crop on server <b>Default: \"cropped\"</b> <i>Optional: \"full\"</i>\r\n\t     */\n\t    \"sendFormat\": {\n\t        \"value\": \"cropped\",\n\t        \"domAttr\": \"data-sendFormat\"\n\t    },\n\t    /**\r\n\t     *  Preloading of image  <b>Default: \"false\"</b> <i>Optional: url of image to preload</i>\r\n\t     */\n\t    \"ajaximage\": {\n\t        \"value\": false,\n\t        \"domAttr\": \"data-ajaximage\"\n\t    },\n\t    \"template\": {\n\t        \"domAttr\": \"data-template\"\n\t    },\n\t    /**\r\n\t     *  Request address for submitting (if there is no form) <b>Default: \"false\"</b> <i>Optional: request URL</i>\r\n\t     */\n\t    \"ajaxAddress\": {\n\t        \"value\": false,\n\t        \"domAttr\": \"data-ajaxAddress\"\n\t    },\n\t    /**\r\n\t     *  Locked aspect ratio <b>Default: false</b>\r\n\t     */\n\t    \"aspectRatio\": {\n\t        \"value\": false,\n\t        \"domAttr\": \"data-aspectRatio\"\n\t    },\n\t    /**\r\n\t     *  What info to show <b>Default: []</b></br>\r\n\t     *  <b>Example: </b>data-showInfo=\"ratio,origSize,croppedSize\"</br>\r\n\t     *  <b>Note: </b>done only ratio\r\n\t     */\n\t    \"showInfo\": {\n\t        \"value\": [],\n\t        \"domAttr\": \"data-showInfo\"\n\t    },\n\t    /**\r\n\t     *  ID of preview element <b>Default: \"\"</b>\r\n\t     */\n\t    \"previewSelector\": {\n\t        \"value\": \"\",\n\t        \"domAttr\": \"data-previewSelector\"\n\t    },\n\t    /**\r\n\t     *  Selector of element which twiggers crop-modal <b>Default: \"\"</b>\r\n\t     */\n\t    \"adjustSelector\": {\n\t        \"value\": \"\",\n\t        \"domAttr\": \"data-adjustSelector\"\n\t    },\n\t    /**\r\n\t     *  Name for formData <b>Default: \"cropped\"</b>\r\n\t     */\n\t    \"name\": {\n\t        \"value\": \"cropped\",\n\t        \"domAttr\": \"data-name\"\n\t    }\n\t};\n\tCrop.prototype.reset = function () {\n\t    //Coordinates and Variables\n\t    this.cnv = {\n\t        cursor: { x: 0, y: 0 },\n\t        crop: { x: 0, y: 0, x2: 0, y2: 0, w: 0, h: 0 },\n\t        toSave: { x: 0, y: 0, w: 0, h: 0 },\n\t        image: { w: 0, h: 0 },\n\t        old: {\n\t            cursor: { x: 0, y: 0 }\n\t        },\n\t        start: {\n\t            crop: { x: 0, y: 0, w: 0, h: 0 }\n\t        },\n\t        canvas: { w: 538, h: 0 },\n\t        orig: {},\n\t        preview: { w: 0, h: 0 },\n\t        scale: 1\n\t    };\n\t    this.setTop(0);\n\t    this.setLeft(0);\n\t    this.setWidth(0);\n\t    this.setHeight(0);\n\n\t    if (this.els.imageOriginal.lastChild) this.els.imageOriginal.removeChild(this.els.imageOriginal.lastChild);\n\t};\n\t/**\r\n\t * Changes crop info if need.\r\n\t * @param type {string}\r\n\t * @param value {string|number}\r\n\t */\n\tCrop.prototype.changeInfo = function (type, value) {\n\t    switch (type) {\n\t        case \"ratio\":\n\t            this.els.cropInfo.ratio.innerHTML = \"Aspect ratio: \" + value;\n\t            break;\n\t        case \"croppedSize\":\n\t            this.els.cropInfo.croppedSize.innerHTML = \"Cropped size: \" + value[0] + 'x' + value[1];\n\t            break;\n\t        case \"origSize\":\n\t            this.els.cropInfo.origSize.innerHTML = \"Original size: \" + value[0] + 'x' + value[1];\n\t            break;\n\t        default:\n\t            break;\n\t    }\n\t};\n\t/**\r\n\t * Update cropping info.\r\n\t */\n\tCrop.prototype.updateInfo = function () {\n\t    var that = this;\n\t    if (this.options.showInfo.length > 0) {\n\t        this.options.showInfo.forEach(function (info) {\n\t            if (info == \"ratio\") that.changeInfo(\"ratio\", Math.round(that.cnv.crop.w / that.cnv.crop.h * 100) / 100);\n\t            if (info == \"croppedSize\") that.changeInfo(\"croppedSize\", [Math.round(that.cnv.crop.w * that.cnv.scale), Math.round(that.cnv.crop.h * that.cnv.scale)]);\n\t        });\n\t    }\n\t};\n\t/**\r\n\t * Shows modal with cropper\r\n\t */\n\tCrop.prototype.showPopup = function () {\n\t    document.body.appendChild(this.els.modal);\n\t    this.addModalEventListeners();\n\t    this.removeEventListeners();\n\t};\n\t/**\r\n\t * Hides modal with cropper\r\n\t */\n\tCrop.prototype.hidePopup = function () {\n\t    this.els.modal.parentNode.removeChild(this.els.modal);\n\t    this.removeModalEventListeners();\n\t    this.addEventListeners();\n\t};\n\n\t/**\r\n\t * Adds static events listeners.\r\n\t */\n\tCrop.prototype.addEventListeners = function () {\n\t    var that = this;\n\n\t    this._inputChange = function (e) {\n\t        //IE9 doesn't support File API\n\t        var file = e.target.files[0];\n\t        if (!file.type.match(/image/)) {\n\t            alert(\"Please select an image.\");\n\t            return;\n\t        }\n\t        that.handleFileSelect(file);\n\t        if (that.els.adjust) that.els.adjust.style.display = 'inline-block';\n\t    };\n\n\t    this._openCropper = function (e) {\n\t        if (that.img) {\n\t            if (that.readyToPrepare) that.prepare();\n\t            that.showPopup();\n\t        }\n\t    };\n\n\t    if (this.els.input) {\n\t        this.els.input.addEventListener('change', this._inputChange);\n\t    }\n\t    if (this.els.preview) {\n\t        this.els.preview.addEventListener('click', this._openCropper);\n\t    }\n\t    if (this.els.adjust) {\n\t        this.els.adjust.addEventListener('click', this._openCropper);\n\t    }\n\t};\n\n\tCrop.prototype.removeEventListeners = function () {\n\t    if (this.els.input) {\n\t        this.els.input.removeEventListener('change', this._inputChange);\n\t    }\n\t    if (this.els.preview) {\n\t        this.els.preview.removeEventListener('click', this._openCropper);\n\t    }\n\t    if (this.els.adjust) {\n\t        this.els.adjust.removeEventListener('click', this._openCropper);\n\t    }\n\t};\n\n\t/**\r\n\t * Adds events listeners for modal.\r\n\t */\n\tCrop.prototype.addModalEventListeners = function () {\n\t    var that = this;\n\n\t    this._cropSave = function () {\n\t        that.save();\n\t        that.hidePopup();\n\t    };\n\n\t    this._hidePopup = function () {\n\t        //this fn to save correct \"this\" and to be able to remove listener later\n\t        that.hidePopup();\n\t    };\n\n\t    this._cropWrapperMouseDown = function (e) {\n\t        that.onCropStart(e);\n\t        that.inCropping = true;\n\t    };\n\n\t    this._documentMouseMove = function (e) {\n\t        if (that.inCropping) {\n\t            e.preventDefault(); //prevent selecting background elements\n\t            that.onCrop(e);\n\t        }\n\t    };\n\n\t    this._cropWrapperMouseUp = function () {\n\t        that.onCropEnd();\n\t        that.inCropping = false;\n\t    };\n\n\t    this._documentMouseUp = function () {\n\t        that.onCropEnd();\n\t        that.inCropping = false;\n\t    };\n\t    this.els.closePopup.addEventListener(\"click\", this._hidePopup);\n\t    this.els.cropSave.addEventListener(\"click\", this._cropSave);\n\t    this.els.cropWrapper.addEventListener(\"mousedown\", this._cropWrapperMouseDown);\n\t    this.els.cropWrapper.addEventListener(\"mouseup\", this._cropWrapperMouseUp);\n\t    document.addEventListener(\"mousemove\", this._documentMouseMove);\n\t    document.addEventListener(\"mouseup\", this._documentMouseUp);\n\t};\n\n\tCrop.prototype.removeModalEventListeners = function () {\n\t    this.els.closePopup.removeEventListener(\"click\", this._hidePopup);\n\t    this.els.cropSave.removeEventListener(\"click\", this._cropSave);\n\t    this.els.cropWrapper.removeEventListener(\"mousedown\", this._cropWrapperMouseDown);\n\t    this.els.cropWrapper.removeEventListener(\"mouseup\", this._cropWrapperMouseUp);\n\t    document.removeEventListener(\"mousemove\", this._documentMouseMove);\n\t    document.removeEventListener(\"mouseup\", this._documentMouseUp);\n\t};\n\n\t/**\r\n\t * Sets preview\r\n\t * @param img\r\n\t */\n\tCrop.prototype.setPreviewImage = function (img) {\n\t    var that = this;\n\t    if (that.els.preview) {\n\t        //        if (that.els.preview.lastChild) // Don't remember why was removing only last child\n\t        //            that.els.preview.removeChild(that.els.preview.lastChild);\n\t        while (that.els.preview.firstChild) {\n\t            that.els.preview.removeChild(that.els.preview.firstChild);\n\t        }\n\t        var newimg = img.cloneNode(true);\n\t        newimg.style.maxWidth = \"100%\";\n\t        that.els.preview.appendChild(newimg);\n\t    }\n\t};\n\t/**\r\n\t * Reads file, selected by user\r\n\t * @param file\r\n\t */\n\tCrop.prototype.handleFileSelect = function (file) {\n\t    var that = this;\n\t    this.reader = new FileReader();\n\t    this.reset();\n\t    this.reader.onload = function (theFile) {\n\t        return function (e) {\n\t            that.file = {\n\t                file: theFile,\n\t                blob: theFile,\n\t                name: encodeURIComponent(theFile.name ? theFile.name : that.options.ajaximage.replace(/^.*[\\\\\\/]/, '')),\n\t                base64: e.target.result\n\t            };\n\t            that.img = new Image();\n\t            that.img.src = that.file.base64;\n\t            that.img.onload = function () {\n\t                that.setPreviewImage(that.img);\n\t                that.cnv.preview.h = that.img.clientHeight;\n\t                that.cnv.preview.w = that.img.clientWidth;\n\t                that.cnv.orig.h = that.img.naturalHeight;\n\t                that.cnv.orig.w = that.img.naturalWidth;\n\t                that.cnv.orig.ratio = that.cnv.orig.w / that.cnv.orig.h;\n\t                if (that.cnv.orig.ratio < 1) that.cnv.canvas.w *= that.cnv.orig.ratio; // if image is too narrow -> correct canvas sizes not to exceed display sizes\n\t                that.cnv.scale = that.cnv.orig.w / that.cnv.canvas.w;\n\t                that.cnv.toSave.w = that.cnv.orig.w;\n\t                that.cnv.toSave.h = that.cnv.orig.h;\n\n\t                if (that.els.imageOriginal.lastChild) that.els.imageOriginal.removeChild(that.els.imageOriginal.lastChild);\n\t                that.readyToPrepare = true;\n\t                that.options.onFileProcessed();\n\t            };\n\t        };\n\t    }(file);\n\n\t    this.reader.readAsDataURL(file);\n\t};\n\n\t/**\r\n\t * Prepares canvas, calculates coordinates\r\n\t */\n\tCrop.prototype.prepare = function () {\n\t    var that = this;\n\t    var c = document.createElement(\"canvas\");\n\t    c.width = that.cnv.canvas.w;\n\t    c.height = that.cnv.canvas.w / that.cnv.orig.ratio;\n\t    var ctx = c.getContext(\"2d\");\n\n\t    function drawImageOnCanvas() {\n\t        //fix to NS_ERROR_NOT_AVAILABLE in firefox with ctx.drawImage\n\t        try {\n\t            ctx.drawImage(that.img, 0, 0, that.cnv.canvas.w, that.cnv.canvas.w / that.cnv.orig.ratio);\n\t        } catch (e) {\n\t            if (e.name == \"NS_ERROR_NOT_AVAILABLE\") {\n\t                setTimeout(drawImageOnCanvas, 0);\n\t            } else {\n\t                throw e;\n\t            }\n\t        }\n\t    }\n\n\t    drawImageOnCanvas();\n\t    that.els.imageOriginal.appendChild(c);\n\t    setTimeout(function () {\n\t        that.cnv.image.w = that.els.imageOriginal.lastChild.clientWidth;\n\t        that.cnv.image.h = that.els.imageOriginal.lastChild.clientHeight;\n\t        that.cnv.start.crop.w = that.cnv.image.w;\n\t        that.cnv.start.crop.h = that.cnv.image.h;\n\t        that.setWidth(that.cnv.image.w);\n\t        that.setHeight(that.cnv.image.h);\n\t        that.cnv.crop.x2 = that.cnv.image.w;\n\t        that.cnv.crop.y2 = that.cnv.image.h;\n\n\t        if (that.options.aspectRatio) {\n\t            if (that.cnv.orig.ratio > that.options.aspectRatio) {\n\t                var w = that.cnv.crop.w;\n\t                that.setWidth(Math.round(that.cnv.start.crop.h * that.options.aspectRatio));\n\t                that.cnv.start.crop.w = that.cnv.crop.w;\n\t                that.setLeft(Math.round((w - that.cnv.crop.w) / 2));\n\t                that.cnv.crop.x2 = that.cnv.crop.x + that.cnv.crop.w;\n\t            } else {\n\t                var h = that.cnv.crop.h;\n\t                that.setHeight(Math.round(that.cnv.start.crop.w / that.options.aspectRatio));\n\t                that.cnv.start.crop.h = that.cnv.crop.h;\n\t                that.setTop(Math.round((h - that.cnv.crop.h) / 2));\n\t                that.cnv.crop.y2 = that.cnv.crop.y + that.cnv.crop.h;\n\t            }\n\n\t            that.save();\n\t        }\n\t        that.updateInfo();\n\t        if (that.options.showInfo.indexOf(\"origSize\") > -1) {\n\t            that.changeInfo(\"origSize\", [that.cnv.orig.w, that.cnv.orig.h]); //no need to pass through updateInfo since it's static\n\t        }\n\n\t        that.readyToPrepare = false;\n\t    }, 50);\n\t};\n\n\t/**\r\n\t * Processes crop start.\r\n\t * @param {Event} e\r\n\t */\n\tCrop.prototype.onCropStart = function (e) {\n\t    this.els.handlers.current = e.target;\n\t    this.cnv.offset = this.els.cropWrapper.getBoundingClientRect();\n\t    this.cnv.cursor.x = Math.round(e.clientX - this.cnv.offset.left);\n\t    this.cnv.cursor.y = Math.round(e.clientY - this.cnv.offset.top);\n\t    this.cnv.cursor.offsetX = e.offsetX === undefined ? Math.round(e.layerX) : Math.round(e.offsetX);\n\t    this.cnv.cursor.offsetY = e.offsetY === undefined ? Math.round(e.layerY) : Math.round(e.offsetY);\n\t};\n\n\t/**\r\n\t * Processes cropping (mouse move)\r\n\t * @param  {Event} e\r\n\t */\n\tCrop.prototype.onCrop = function (e) {\n\t    if (!this.els.handlers.current) return;\n\t    this.cnv.cursor.x = Math.round(e.clientX - this.cnv.offset.left);\n\t    this.cnv.cursor.y = Math.round(e.clientY - this.cnv.offset.top);\n\t    switch (this.els.handlers.current) {\n\t        case this.els.handlers.n:\n\t            this.setN();\n\t            break;\n\t        case this.els.handlers.ne:\n\t            this.setNE();\n\t            break;\n\t        case this.els.handlers.e:\n\t            this.setE();\n\t            break;\n\t        case this.els.handlers.se:\n\t            this.setSE();\n\t            break;\n\t        case this.els.handlers.s:\n\t            this.setS();\n\t            break;\n\t        case this.els.handlers.sw:\n\t            this.setSW();\n\t            break;\n\t        case this.els.handlers.w:\n\t            this.setW();\n\t            break;\n\t        case this.els.handlers.nw:\n\t            this.setNW();\n\t            break;\n\t        case this.els.cropElements:\n\t            this.move();\n\t            break;\n\t    }\n\t    this.updateInfo();\n\t    //    this.setDimmers();\n\t};\n\n\t/**\r\n\t * Process crop end.\r\n\t */\n\tCrop.prototype.onCropEnd = function () {\n\t    this.els.handlers.current = null;\n\t};\n\t/**\r\n\t * Sets left side of cropper\r\n\t * @param x {number}\r\n\t */\n\tCrop.prototype.setLeft = function (x) {\n\t    this.cnv.crop.x = x;\n\t    this.els.cropElements.style.left = x + \"px\";\n\t    this.els.dimmers.el.style.left = x + \"px\";\n\t};\n\t/**\r\n\t * Sets top side of cropper\r\n\t * @param y {number}\r\n\t */\n\tCrop.prototype.setTop = function (y) {\n\t    this.cnv.crop.y = y;\n\t    this.els.cropElements.style.top = y + \"px\";\n\t    this.els.dimmers.el.style.top = y + \"px\";\n\t};\n\t/**\r\n\t * Sets width of cropper\r\n\t * @param w {number}\r\n\t */\n\tCrop.prototype.setWidth = function (w) {\n\t    this.cnv.crop.w = w;\n\t    this.els.cropElements.style.width = w + \"px\";\n\t    this.els.dimmers.el.style.width = w + \"px\";\n\t};\n\t/**\r\n\t * Sets height of cropper\r\n\t * @param h {number}\r\n\t */\n\tCrop.prototype.setHeight = function (h) {\n\t    this.cnv.crop.h = h;\n\t    this.els.cropElements.style.height = h + \"px\";\n\t    this.els.dimmers.el.style.height = h + \"px\";\n\t};\n\n\t/**\r\n\t * Adjusts coordinates.\r\n\t * @param {boolean|undefined} notDefaultSide\r\n\t * @param {number} y\r\n\t */\n\tCrop.prototype.adjustN = function (notDefaultSide, y) {\n\t    if (notDefaultSide) {\n\t        if ((this.cnv.crop.y2 - y) * this.options.aspectRatio <= this.cnv.crop.x2) {\n\t            this.setTop(y);\n\t            this.setHeight(this.cnv.crop.y2 - y);\n\t            this.setWidth(Math.round(this.cnv.crop.h * this.options.aspectRatio));\n\t            this.setLeft(this.cnv.crop.x2 - this.cnv.crop.w);\n\t        } else {\n\t            this.setLeft(0);\n\t            this.setWidth(this.cnv.crop.x2);\n\t            this.setTop(this.cnv.crop.y2 - Math.round(this.cnv.crop.w / this.options.aspectRatio));\n\t        }\n\t    } else {\n\t        if ((this.cnv.crop.y2 - y) * this.options.aspectRatio + this.cnv.crop.x <= this.cnv.image.w) {\n\t            this.setTop(y);\n\t            this.setHeight(this.cnv.crop.y2 - y);\n\t            this.setWidth(Math.round(this.cnv.crop.h * this.options.aspectRatio));\n\t            this.cnv.crop.x2 = this.cnv.crop.x + this.cnv.crop.w;\n\t        } else {\n\t            this.setWidth(this.cnv.image.w - this.cnv.crop.x);\n\t            this.setTop(this.cnv.crop.y2 - Math.round(this.cnv.crop.w / this.options.aspectRatio));\n\t            this.setHeight(this.cnv.crop.y2 - this.cnv.crop.y);\n\t            this.cnv.crop.x2 = this.cnv.image.w;\n\t        }\n\t    }\n\t};\n\n\t/**\r\n\t * Sets top coordinates and border.\r\n\t * @param {Boolean} [notDefaultSide]\r\n\t */\n\tCrop.prototype.setN = function (notDefaultSide) {\n\t    if (this.options.aspectRatio) {\n\t        if (this.cnv.cursor.y > 0) {\n\t            if (this.cnv.cursor.y < this.cnv.crop.y2) {\n\t                this.adjustN(notDefaultSide, this.cnv.cursor.y);\n\t            } else {\n\t                this.setHeight(1);\n\t                this.setWidth(Math.round(this.cnv.crop.h * this.options.aspectRatio));\n\t                if (notDefaultSide) {\n\t                    this.setLeft(this.cnv.crop.x2 - 1);\n\t                } else {\n\t                    this.cnv.crop.x2 = this.cnv.crop.x + this.cnv.crop.w;\n\t                }\n\t                this.setTop(this.cnv.crop.y2 - 1);\n\t            }\n\t        } else {\n\t            this.adjustN(notDefaultSide, 0);\n\t        }\n\t    } else {\n\t        if (this.cnv.cursor.y > 0) {\n\t            if (this.cnv.cursor.y < this.cnv.crop.y2) {\n\t                this.setTop(this.cnv.cursor.y);\n\t                this.setHeight(this.cnv.crop.y2 - this.cnv.crop.y);\n\t            } else {\n\t                this.setTop(this.cnv.crop.y2 - 1);\n\t                this.setHeight(1);\n\t            }\n\t        } else {\n\t            this.setTop(0);\n\t            this.setHeight(this.cnv.crop.y2);\n\t        }\n\t    }\n\t};\n\n\t/**\r\n\t * Adjusts coordinates.\r\n\t * @param {boolean|undefined} notDefaultSide\r\n\t * @param {number} y2\r\n\t */\n\tCrop.prototype.adjustS = function (notDefaultSide, y2) {\n\t    if (notDefaultSide) {\n\t        if ((y2 - this.cnv.crop.y) * this.options.aspectRatio <= this.cnv.crop.x2) {\n\t            this.setHeight(y2 - this.cnv.crop.y);\n\t            this.setWidth(Math.round(this.cnv.crop.h * this.options.aspectRatio));\n\t            this.setLeft(this.cnv.crop.x2 - this.cnv.crop.w);\n\t            this.cnv.crop.y2 = y2;\n\t        } else {\n\t            this.setLeft(0);\n\t            this.setWidth(this.cnv.crop.x2);\n\t            this.setHeight(Math.round(this.cnv.crop.w / this.options.aspectRatio));\n\t            this.cnv.crop.y2 = this.cnv.crop.y + this.cnv.crop.h;\n\t        }\n\t    } else {\n\t        if ((y2 - this.cnv.crop.y) * this.options.aspectRatio + this.cnv.crop.x <= this.cnv.image.w) {\n\t            this.setHeight(y2 - this.cnv.crop.y);\n\t            this.setWidth(Math.round(this.cnv.crop.h * this.options.aspectRatio));\n\t            this.cnv.crop.y2 = y2;\n\t            this.cnv.crop.x2 = this.cnv.crop.x + this.cnv.crop.w;\n\t        } else {\n\t            this.setWidth(this.cnv.image.w - this.cnv.crop.x);\n\t            this.setHeight(Math.round(this.cnv.crop.w / this.options.aspectRatio));\n\t            this.cnv.crop.x2 = this.cnv.image.w;\n\t            this.cnv.crop.y2 = this.cnv.crop.y + this.cnv.crop.h;\n\t        }\n\t    }\n\t};\n\n\t/**\r\n\t * Sets bottom coordinates and border.\r\n\t * @param {Boolean} [notDefaultSide]\r\n\t */\n\tCrop.prototype.setS = function (notDefaultSide) {\n\t    if (this.options.aspectRatio) {\n\t        if (this.cnv.cursor.y < this.cnv.image.h) {\n\t            if (this.cnv.cursor.y > this.cnv.crop.y) {\n\t                this.adjustS(notDefaultSide, this.cnv.cursor.y);\n\t            } else {\n\t                this.setHeight(1);\n\t                this.setWidth(Math.round(this.cnv.crop.h * this.options.aspectRatio));\n\t                if (notDefaultSide) {\n\t                    this.setLeft(this.cnv.crop.x2 - 1);\n\t                } else {\n\t                    this.cnv.crop.x2 = this.cnv.crop.x + this.cnv.crop.w;\n\t                }\n\t                this.cnv.crop.y2 = this.cnv.crop.y + 1;\n\t            }\n\t        } else {\n\t            this.adjustS(notDefaultSide, this.cnv.image.h);\n\t        }\n\t    } else {\n\t        if (this.cnv.cursor.y < this.cnv.image.h) {\n\t            if (this.cnv.cursor.y > this.cnv.crop.y) {\n\t                this.setHeight(this.cnv.cursor.y - this.cnv.crop.y);\n\t                this.cnv.crop.y2 = this.cnv.cursor.y;\n\t            } else {\n\t                this.setHeight(1);\n\t                this.cnv.crop.y2 = this.cnv.crop.y + 1;\n\t            }\n\t        } else {\n\t            this.setHeight(this.cnv.image.h - this.cnv.crop.y);\n\t            this.cnv.crop.y2 = this.cnv.image.h;\n\t        }\n\t    }\n\t};\n\n\t/**\r\n\t * Adjusts coordinates.\r\n\t * @param {boolean|undefined} notDefaultSide\r\n\t * @param {number} x\r\n\t */\n\tCrop.prototype.adjustW = function (notDefaultSide, x) {\n\t    if (notDefaultSide) {\n\t        if (this.cnv.crop.y2 - (this.cnv.crop.x2 - x) / this.options.aspectRatio >= 0) {\n\t            this.setLeft(x);\n\t            this.setWidth(this.cnv.crop.x2 - x);\n\t            this.setHeight(Math.round(this.cnv.crop.w / this.options.aspectRatio));\n\t            this.setTop(this.cnv.crop.y2 - this.cnv.crop.h);\n\t        } else {\n\t            this.setTop(0);\n\t            this.setHeight(this.cnv.crop.y2);\n\t            this.setWidth(Math.round(this.cnv.crop.h * this.options.aspectRatio));\n\t            this.setLeft(this.cnv.crop.x2 - this.cnv.crop.w);\n\t        }\n\t    } else {\n\t        if ((this.cnv.crop.x2 - x) / this.options.aspectRatio + this.cnv.crop.y <= this.cnv.image.h) {\n\t            this.setLeft(x);\n\t            this.setWidth(this.cnv.crop.x2 - x);\n\t            this.setHeight(Math.round(this.cnv.crop.w / this.options.aspectRatio));\n\t            this.cnv.crop.y2 = this.cnv.crop.y + this.cnv.crop.h;\n\t        } else {\n\t            this.setHeight(this.cnv.image.h - this.cnv.crop.y);\n\t            this.setWidth(Math.round(this.cnv.crop.h * this.options.aspectRatio));\n\t            this.setLeft(this.cnv.crop.x2 - this.cnv.crop.w);\n\t            this.cnv.crop.y2 = this.cnv.image.h;\n\t        }\n\t    }\n\t};\n\n\t/**\r\n\t * Sets left coordinates and border.\r\n\t * @param {Boolean} [notDefaultSide]\r\n\t */\n\tCrop.prototype.setW = function (notDefaultSide) {\n\t    if (this.options.aspectRatio) {\n\t        if (this.cnv.cursor.x > 0) {\n\t            if (this.cnv.cursor.x < this.cnv.crop.x2) {\n\t                this.adjustW(notDefaultSide, this.cnv.cursor.x);\n\t            } else {\n\t                this.setWidth(1);\n\t                this.setHeight(Math.round(this.cnv.crop.w / this.options.aspectRatio));\n\t                if (notDefaultSide) {\n\t                    this.setTop(this.cnv.crop.y2 - 1);\n\t                } else {\n\t                    this.cnv.crop.y2 = this.cnv.crop.y + this.cnv.crop.h;\n\t                }\n\t            }\n\t        } else {\n\t            this.adjustW(notDefaultSide, 0);\n\t        }\n\t    } else {\n\t        if (this.cnv.cursor.x > 0) {\n\t            if (this.cnv.cursor.x < this.cnv.crop.x2) {\n\t                this.setLeft(this.cnv.cursor.x);\n\t                this.setWidth(this.cnv.crop.x2 - this.cnv.crop.x);\n\t            } else {\n\t                this.setLeft(this.cnv.crop.x2 - 1);\n\t                this.setWidth(1);\n\t            }\n\t        } else {\n\t            this.setLeft(0);\n\t            this.setWidth(this.cnv.crop.x2);\n\t        }\n\t    }\n\t};\n\n\t/**\r\n\t * Adjusts coordinates.\r\n\t * @param {boolean|undefined} notDefaultSide\r\n\t * @param {number} x\r\n\t */\n\tCrop.prototype.adjustE = function (notDefaultSide, x) {\n\t    if (notDefaultSide) {\n\t        if (this.cnv.crop.y2 - (x - this.cnv.crop.x) / this.options.aspectRatio >= 0) {\n\t            this.setWidth(x - this.cnv.crop.x);\n\t            this.setHeight(Math.round(this.cnv.crop.w / this.options.aspectRatio));\n\t            this.setTop(this.cnv.crop.y2 - this.cnv.crop.h);\n\t            this.cnv.crop.x2 = x;\n\t        } else {\n\t            this.setTop(0);\n\t            this.setHeight(this.cnv.crop.y2);\n\t            this.setWidth(Math.round(this.cnv.crop.h * this.options.aspectRatio));\n\t            this.cnv.crop.x2 = this.cnv.crop.x + this.cnv.crop.w;\n\t        }\n\t    } else {\n\t        if ((x - this.cnv.crop.x) / this.options.aspectRatio + this.cnv.crop.y <= this.cnv.image.h) {\n\t            this.setWidth(x - this.cnv.crop.x);\n\t            this.setHeight(Math.round(this.cnv.crop.w / this.options.aspectRatio));\n\t            this.cnv.crop.x2 = x;\n\t            this.cnv.crop.y2 = this.cnv.crop.y + this.cnv.crop.h;\n\t        } else {\n\t            this.setHeight(this.cnv.image.h - this.cnv.crop.y);\n\t            this.setWidth(Math.round(this.cnv.crop.h * this.options.aspectRatio));\n\t            this.cnv.crop.y2 = this.cnv.image.h;\n\t            this.cnv.crop.x2 = this.cnv.crop.x + this.cnv.crop.w;\n\t        }\n\t    }\n\t};\n\n\t/**\r\n\t * Sets right coordinates and border.\r\n\t * @param {Boolean} [notDefaultSide]\r\n\t */\n\tCrop.prototype.setE = function (notDefaultSide) {\n\t    if (this.options.aspectRatio) {\n\t        if (this.cnv.cursor.x < this.cnv.image.w) {\n\t            if (this.cnv.cursor.x > this.cnv.crop.x) {\n\t                this.adjustE(notDefaultSide, this.cnv.cursor.x);\n\t            } else {\n\t                this.setWidth(1);\n\t                this.setHeight(Math.round(this.cnv.crop.w / this.options.aspectRatio));\n\t                if (notDefaultSide) {\n\t                    this.setTop(this.cnv.crop.y2 - 1);\n\t                } else {\n\t                    this.cnv.crop.y2 = this.cnv.crop.y + this.cnv.crop.h;\n\t                }\n\t                this.cnv.crop.x2 = this.cnv.crop.x + 1;\n\t            }\n\t        } else {\n\t            this.adjustE(notDefaultSide, this.cnv.image.w);\n\t        }\n\t    } else {\n\t        if (this.cnv.cursor.x < this.cnv.image.w) {\n\t            if (this.cnv.cursor.x > this.cnv.crop.x) {\n\t                this.setWidth(this.cnv.cursor.x - this.cnv.crop.x);\n\t                this.cnv.crop.x2 = this.cnv.cursor.x;\n\t            } else {\n\t                this.setWidth(1);\n\t                this.cnv.crop.x2 = this.cnv.crop.x + 1;\n\t            }\n\t        } else {\n\t            this.setWidth(this.cnv.image.w - this.cnv.crop.x);\n\t            this.cnv.crop.x2 = this.cnv.image.w;\n\t        }\n\t    }\n\t};\n\n\t/**\r\n\t * Sets top-right corner.\r\n\t */\n\tCrop.prototype.setNE = function () {\n\t    if (this.options.aspectRatio) {\n\t        if (Math.abs(this.cnv.cursor.x - this.cnv.crop.x2) > Math.abs(this.cnv.cursor.y - this.cnv.crop.y) && this.cnv.cursor.x <= this.cnv.crop.x2) {\n\t            this.setN();\n\t        } else {\n\t            this.cnv.cursor.y >= this.cnv.crop.y ? this.setE(true) : this.setN();\n\t        }\n\t    } else {\n\t        this.setN();\n\t        this.setE();\n\t    }\n\t};\n\n\t/**\r\n\t * Sets bottom-right corner.\r\n\t */\n\tCrop.prototype.setSE = function () {\n\t    if (this.options.aspectRatio) {\n\t        if (Math.abs(this.cnv.cursor.x - this.cnv.crop.x2) > Math.abs(this.cnv.cursor.y - this.cnv.crop.y - this.cnv.crop.h) && this.cnv.cursor.x <= this.cnv.crop.x2) {\n\t            this.setS();\n\t        } else {\n\t            this.cnv.cursor.y <= this.cnv.crop.y + this.cnv.crop.h ? this.setE() : this.setS();\n\t        }\n\t    } else {\n\t        this.setS();\n\t        this.setE();\n\t    }\n\t};\n\n\t/**\r\n\t * Sets bottom-left corner.\r\n\t */\n\tCrop.prototype.setSW = function () {\n\t    if (this.options.aspectRatio) {\n\t        if (Math.abs(this.cnv.cursor.x - this.cnv.crop.x) > Math.abs(this.cnv.cursor.y - this.cnv.crop.y - this.cnv.crop.h) && this.cnv.cursor.x >= this.cnv.crop.x) {\n\t            this.setS(true);\n\t        } else {\n\t            this.cnv.cursor.y <= this.cnv.crop.y + this.cnv.crop.h ? this.setW() : this.setS(true);\n\t        }\n\t    } else {\n\t        this.setS();\n\t        this.setW();\n\t    }\n\t};\n\n\t/**\r\n\t * Sets top-left corner.\r\n\t */\n\tCrop.prototype.setNW = function () {\n\t    if (this.options.aspectRatio) {\n\t        if (Math.abs(this.cnv.cursor.x - this.cnv.crop.x) > Math.abs(this.cnv.cursor.y - this.cnv.crop.y) && this.cnv.cursor.x >= this.cnv.crop.x) {\n\t            this.setN(true);\n\t        } else {\n\t            this.cnv.cursor.y >= this.cnv.crop.y ? this.setW(true) : this.setN(true);\n\t        }\n\t    } else {\n\t        this.setN();\n\t        this.setW();\n\t    }\n\t};\n\n\t/**\r\n\t * Processes move crop selection.\r\n\t */\n\tCrop.prototype.move = function () {\n\t    var left = this.cnv.cursor.x - this.cnv.cursor.offsetX;\n\t    var top = this.cnv.cursor.y - this.cnv.cursor.offsetY;\n\t    if (left > 0) {\n\t        if (left + this.cnv.crop.w < this.cnv.image.w) {\n\t            this.setLeft(left);\n\t        } else {\n\t            this.setLeft(this.cnv.image.w - this.cnv.crop.w);\n\t        }\n\t    } else {\n\t        this.setLeft(0);\n\t    }\n\n\t    if (top > 0) {\n\t        if (top + this.cnv.crop.h < this.cnv.image.h) {\n\t            this.setTop(top);\n\t        } else {\n\t            this.setTop(this.cnv.image.h - this.cnv.crop.h);\n\t        }\n\t    } else {\n\t        this.setTop(0);\n\t    }\n\n\t    this.cnv.crop.x2 = this.cnv.crop.x + this.cnv.crop.w;\n\t    this.cnv.crop.y2 = this.cnv.crop.y + this.cnv.crop.h;\n\t};\n\n\t/**\r\n\t * Deprecated.\r\n\t * Sets dimmers.\r\n\t */\n\tCrop.prototype.setDimmers = function () {\n\t    this.els.dimmers.n.style.top = this.cnv.crop.y - 1000 + \"px\";\n\t    this.els.dimmers.n.style.left = this.cnv.crop.x + \"px\";\n\t    this.els.dimmers.n.style.width = this.cnv.crop.w + \"px\";\n\n\t    this.els.dimmers.e.style.left = this.cnv.crop.x2 + \"px\";\n\n\t    this.els.dimmers.s.style.top = this.cnv.crop.y2 + \"px\";\n\t    this.els.dimmers.s.style.left = this.cnv.crop.x + \"px\";\n\t    this.els.dimmers.s.style.width = this.cnv.crop.w + \"px\";\n\n\t    this.els.dimmers.w.style.left = this.cnv.crop.x - 1000 + \"px\";\n\t};\n\n\t/**\r\n\t * Converts dataURI to Blob.\r\n\t * http://stackoverflow.com/questions/4998908/convert-data-uri-to-file-then-append-to-formdata\r\n\t * @param dataURI\r\n\t * @returns {Blob}\r\n\t */\n\tCrop.prototype.dataURItoBlob = function (dataURI) {\n\n\t    var content = [],\n\t        byteString,\n\t        mimeString;\n\n\t    if (dataURI.split(',')[0].indexOf('base64') !== -1) {\n\t        byteString = atob(dataURI.split(',')[1]);\n\t    } else {\n\t        byteString = decodeURI(dataURI.split(',')[1]);\n\t    }\n\n\t    mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0];\n\n\t    for (var i = 0; i < byteString.length; i++) {\n\t        content[i] = byteString.charCodeAt(i);\n\t    }\n\n\t    return new Blob([new Uint8Array(content)], { type: mimeString });\n\t};\n\n\t/**\r\n\t * Saves results to preview.\r\n\t */\n\tCrop.prototype.save = function () {\n\t    'use strict';\n\n\t    var that = this;\n\t    var c = document.createElement(\"canvas\"),\n\t        ctx = c.getContext(\"2d\"),\n\t        img;\n\t    this.cnv.toSave = { //CoordinateS\n\t        w: Math.round(this.cnv.crop.w * this.cnv.scale),\n\t        h: Math.round(this.cnv.crop.h * this.cnv.scale),\n\t        x: Math.round(this.cnv.crop.x * this.cnv.scale),\n\t        y: Math.round(this.cnv.crop.y * this.cnv.scale)\n\t    };\n\n\t    c.width = this.cnv.toSave.w;\n\t    c.height = this.cnv.toSave.h;\n\n\t    function drawImageOnCanvas() {\n\t        //TODO refactor this piece. Almost the same as in prepare().\n\t        try {\n\t            ctx.drawImage(that.img, that.cnv.toSave.x, that.cnv.toSave.y, that.cnv.toSave.w, that.cnv.toSave.h, 0, 0, that.cnv.toSave.w, that.cnv.toSave.h);\n\t        } catch (e) {\n\t            if (e.name == \"NS_ERROR_NOT_AVAILABLE\") {\n\t                setTimeout(drawImageOnCanvas, 0);\n\t            } else {\n\t                throw e;\n\t            }\n\t        }\n\t    }\n\n\t    drawImageOnCanvas();\n\t    this.strDataURI = c.toDataURL(\"image/jpeg\", 0.95);\n\n\t    img = new Image();\n\t    img.src = this.strDataURI;\n\n\t    this.setPreviewImage(img);\n\t    this.file.blob = this.dataURItoBlob(this.strDataURI);\n\t};\n\n\t/**\r\n\t * Attaches data to formData\r\n\t */\n\tCrop.prototype.attachData = function () {\n\t    var that = this;\n\t    if (this.form) {\n\t        if (this.options.sendFormat == \"cropped\") {\n\t            this.form.events.on(\"onBeforeSend\", function (options) {\n\t                options.data.append(that.options.name, that.file.blob, that.file.name);\n\t            });\n\t        } else {\n\n\t            this.form.events.on(\"onBeforeSend\", function (options) {\n\t                options.data.append(that.options.name, that.file.file, that.file.name);\n\t                options.data.append(that.options.name + \"-cropData[cropWidth]\", that.cnv.toSave.w);\n\t                options.data.append(that.options.name + \"-cropData[cropHeight]\", that.cnv.toSave.h);\n\t                options.data.append(that.options.name + \"-cropData[cropX]\", that.cnv.toSave.x);\n\t                options.data.append(that.options.name + \"-cropData[cropY]\", that.cnv.toSave.y);\n\t            });\n\t        }\n\t    }\n\t};\n\n\tCrop.prototype.die = function () {\n\t    this.removeEventListeners();\n\t    this.removeModalEventListeners();\n\t    delete this;\n\t};\n\n\texports.default = Crop;\n\n/***/ },\n/* 4 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\n\tmodule.exports = { \"default\": __webpack_require__(5), __esModule: true };\n\n/***/ },\n/* 5 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\n\tvar $ = __webpack_require__(6);\n\tmodule.exports = function create(P, D) {\n\t  return $.create(P, D);\n\t};\n\n/***/ },\n/* 6 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\n\tvar $Object = Object;\n\tmodule.exports = {\n\t  create: $Object.create,\n\t  getProto: $Object.getPrototypeOf,\n\t  isEnum: {}.propertyIsEnumerable,\n\t  getDesc: $Object.getOwnPropertyDescriptor,\n\t  setDesc: $Object.defineProperty,\n\t  setDescs: $Object.defineProperties,\n\t  getKeys: $Object.keys,\n\t  getNames: $Object.getOwnPropertyNames,\n\t  getSymbols: $Object.getOwnPropertySymbols,\n\t  each: [].forEach\n\t};\n\n/***/ },\n/* 7 */\n/***/ function(module, exports) {\n\n\tmodule.exports = \"<div class=\\\"sf-crop-modal modal crop\\\">\\r\\n    <div class=\\\"modal-header\\\">\\r\\n        <button class=\\\"close sf-crop-close\\\"></button>\\r\\n        <div class=\\\"cropper-info\\\">\\r\\n            <div class=\\\"sf-crop-ratio\\\"></div>\\r\\n            <div class=\\\"sf-crop-orig-size\\\"></div>\\r\\n            <div class=\\\"sf-crop-cropped-size\\\"></div>\\r\\n        </div>\\r\\n    </div>\\r\\n        <div class=\\\"modal-body\\\">\\r\\n            <div class=\\\"crop-info\\\">\\r\\n                <span class=\\\"crop-ratio\\\"></span>\\r\\n            </div>\\r\\n            <div class=\\\"crop-container\\\">\\r\\n                <div class=\\\"sf-crop-image-original\\\"></div>\\r\\n                <div class=\\\"sf-crop-wrapper crop-wrapper\\\">\\r\\n                    <div class=\\\"dimmers-container\\\">\\r\\n                        <div class=\\\"dimmers\\\">\\r\\n                            <div class=\\\"dimmer dimmer-N\\\"></div>\\r\\n                            <div class=\\\"dimmer dimmer-E\\\"></div>\\r\\n                            <div class=\\\"dimmer dimmer-S\\\"></div>\\r\\n                            <div class=\\\"dimmer dimmer-W\\\"></div>\\r\\n                        </div>\\r\\n                    </div>\\r\\n                    <div class=\\\"sf-crop-elements crop-elements\\\">\\r\\n                        <div class=\\\"handler handler-N\\\"></div>\\r\\n                        <div class=\\\"handler handler-NE\\\"></div>\\r\\n                        <div class=\\\"handler handler-E\\\"></div>\\r\\n                        <div class=\\\"handler handler-SE\\\"></div>\\r\\n                        <div class=\\\"handler handler-S\\\"></div>\\r\\n                        <div class=\\\"handler handler-SW\\\"></div>\\r\\n                        <div class=\\\"handler handler-W\\\"></div>\\r\\n                        <div class=\\\"handler handler-NW\\\"></div>\\r\\n                    </div>\\r\\n                </div>\\r\\n            </div>\\r\\n        </div>\\r\\n        <div class=\\\"modal-footer\\\">\\r\\n            <br>\\r\\n            <button type=\\\"button\\\" class=\\\"sf-crop-save btn-save\\\">Save changes</button>\\r\\n        </div>\\r\\n</div>\\r\\n\";\n\n/***/ },\n/* 8 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t// style-loader: Adds some css to the DOM by adding a <style> tag\n\n\t// load the styles\n\tvar content = __webpack_require__(9);\n\tif(typeof content === 'string') content = [[module.id, content, '']];\n\t// add the styles to the DOM\n\tvar update = __webpack_require__(11)(content, {});\n\tif(content.locals) module.exports = content.locals;\n\t// Hot Module Replacement\n\tif(false) {\n\t\t// When the styles change, update the <style> tags\n\t\tif(!content.locals) {\n\t\t\tmodule.hot.accept(\"!!./../node_modules/css-loader/index.js?minimize!./../node_modules/less-loader/index.js!./crop.less\", function() {\n\t\t\t\tvar newContent = require(\"!!./../node_modules/css-loader/index.js?minimize!./../node_modules/less-loader/index.js!./crop.less\");\n\t\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\t\tupdate(newContent);\n\t\t\t});\n\t\t}\n\t\t// When the module is disposed, remove the <style> tags\n\t\tmodule.hot.dispose(function() { update(); });\n\t}\n\n/***/ },\n/* 9 */\n/***/ function(module, exports, __webpack_require__) {\n\n\texports = module.exports = __webpack_require__(10)();\n\t// imports\n\n\n\t// module\n\texports.push([module.id, \".modal.crop{position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);padding:20px;background-color:#fff;box-shadow:0 0 3px #000;overflow:auto;width:auto;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.modal.crop .btn-save{display:block;margin:0 auto;padding:7px 22px;border-width:0;border-radius:2px;box-shadow:0 1px 2px rgba(0,0,0,.6);background-color:#468ebe;color:#ecf0f1;transition:background-color .3s}.modal.crop .btn-save:focus,.modal.crop .btn-save:hover{background-color:#2778ae}.modal.crop .crop-container{position:relative}.modal.crop .crop-container canvas{display:block}.modal.crop .image-original{font-size:50px}.modal.crop .crop-wrapper{position:absolute;top:0;bottom:0;left:0;right:0}.modal.crop .crop-wrapper .thumb{max-width:100%;max-height:100%}.modal.crop .crop-wrapper .thumb>img{max-width:100%;max-height:100%;position:relative;visibility:hidden;z-index:-1;width:100%;min-width:100%;margin-bottom:-4px}.modal.crop .crop-wrapper .transparent-image{max-width:100%;max-height:100%}.modal.crop .crop-wrapper .crop-elements{position:absolute;border:1px dashed #000;top:0;width:100%;height:100%;max-width:100%;max-height:100%;cursor:move}.modal.crop .crop-wrapper .dimmers-container{position:absolute;overflow:hidden;top:0;bottom:0;left:0;right:0}.modal.crop .crop-wrapper .dimmers{position:absolute}.modal.crop .crop-wrapper .dimmer{position:absolute;width:1000px;height:1000px;background-color:#000;opacity:.3}.modal.crop .crop-wrapper .dimmer.dimmer-N{bottom:100%;left:0}.modal.crop .crop-wrapper .dimmer.dimmer-E{left:100%;top:0}.modal.crop .crop-wrapper .dimmer.dimmer-S{top:100%;right:0}.modal.crop .crop-wrapper .dimmer.dimmer-W{bottom:0;right:100%}.modal.crop .crop-wrapper .handler{position:absolute;border:1px solid #333;width:10px;height:10px;background:#fff;opacity:.5}.modal.crop .crop-wrapper .handler.handler-N{top:0;left:50%;margin-top:-6px;margin-left:-6px;cursor:n-resize}.modal.crop .crop-wrapper .handler.handler-NE{top:0;right:0;margin-top:-6px;margin-right:-6px;cursor:ne-resize}.modal.crop .crop-wrapper .handler.handler-E{top:50%;right:0;margin-top:-6px;margin-right:-6px;cursor:e-resize}.modal.crop .crop-wrapper .handler.handler-SE{bottom:0;right:0;margin-bottom:-6px;margin-right:-6px;cursor:se-resize}.modal.crop .crop-wrapper .handler.handler-S{bottom:0;left:50%;margin-bottom:-6px;margin-left:-6px;cursor:s-resize}.modal.crop .crop-wrapper .handler.handler-SW{bottom:0;left:0;margin-bottom:-6px;margin-left:-6px;cursor:sw-resize}.modal.crop .crop-wrapper .handler.handler-W{top:50%;left:0;margin-top:-6px;margin-left:-6px;cursor:w-resize}.modal.crop .crop-wrapper .handler.handler-NW{top:0;left:0;margin-top:-6px;margin-left:-6px;cursor:nw-resize}.modal.crop .crop-save{width:100%}.modal.crop .change-orientation{position:relative;top:-15px}.modal.crop .modal-header{margin-bottom:20px}.modal.crop .modal-header .cropper-info{font-size:12px}.modal.crop .modal-header .close{position:absolute;background:transparent;padding:0;top:10px;right:15px;font-size:24px;border:none;opacity:.2;cursor:pointer}.modal.crop .modal-header .close:hover{opacity:1}\", \"\"]);\n\n\t// exports\n\n\n/***/ },\n/* 10 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\n\t/*\r\n\t\tMIT License http://www.opensource.org/licenses/mit-license.php\r\n\t\tAuthor Tobias Koppers @sokra\r\n\t*/\n\t// css base code, injected by the css-loader\n\tmodule.exports = function () {\n\t\tvar list = [];\n\n\t\t// return the list of modules as css string\n\t\tlist.toString = function toString() {\n\t\t\tvar result = [];\n\t\t\tfor (var i = 0; i < this.length; i++) {\n\t\t\t\tvar item = this[i];\n\t\t\t\tif (item[2]) {\n\t\t\t\t\tresult.push(\"@media \" + item[2] + \"{\" + item[1] + \"}\");\n\t\t\t\t} else {\n\t\t\t\t\tresult.push(item[1]);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn result.join(\"\");\n\t\t};\n\n\t\t// import a list of modules into the list\n\t\tlist.i = function (modules, mediaQuery) {\n\t\t\tif (typeof modules === \"string\") modules = [[null, modules, \"\"]];\n\t\t\tvar alreadyImportedModules = {};\n\t\t\tfor (var i = 0; i < this.length; i++) {\n\t\t\t\tvar id = this[i][0];\n\t\t\t\tif (typeof id === \"number\") alreadyImportedModules[id] = true;\n\t\t\t}\n\t\t\tfor (i = 0; i < modules.length; i++) {\n\t\t\t\tvar item = modules[i];\n\t\t\t\t// skip already imported module\n\t\t\t\t// this implementation is not 100% perfect for weird media query combinations\n\t\t\t\t//  when a module is imported multiple times with different media queries.\n\t\t\t\t//  I hope this will never occur (Hey this way we have smaller bundles)\n\t\t\t\tif (typeof item[0] !== \"number\" || !alreadyImportedModules[item[0]]) {\n\t\t\t\t\tif (mediaQuery && !item[2]) {\n\t\t\t\t\t\titem[2] = mediaQuery;\n\t\t\t\t\t} else if (mediaQuery) {\n\t\t\t\t\t\titem[2] = \"(\" + item[2] + \") and (\" + mediaQuery + \")\";\n\t\t\t\t\t}\n\t\t\t\t\tlist.push(item);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\treturn list;\n\t};\n\n/***/ },\n/* 11 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/*\r\n\t\tMIT License http://www.opensource.org/licenses/mit-license.php\r\n\t\tAuthor Tobias Koppers @sokra\r\n\t*/\r\n\tvar stylesInDom = {},\r\n\t\tmemoize = function(fn) {\r\n\t\t\tvar memo;\r\n\t\t\treturn function () {\r\n\t\t\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\r\n\t\t\t\treturn memo;\r\n\t\t\t};\r\n\t\t},\r\n\t\tisOldIE = memoize(function() {\r\n\t\t\treturn /msie [6-9]\\b/.test(window.navigator.userAgent.toLowerCase());\r\n\t\t}),\r\n\t\tgetHeadElement = memoize(function () {\r\n\t\t\treturn document.head || document.getElementsByTagName(\"head\")[0];\r\n\t\t}),\r\n\t\tsingletonElement = null,\r\n\t\tsingletonCounter = 0,\r\n\t\tstyleElementsInsertedAtTop = [];\r\n\r\n\tmodule.exports = function(list, options) {\r\n\t\tif(false) {\r\n\t\t\tif(typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\r\n\t\t}\r\n\r\n\t\toptions = options || {};\r\n\t\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\r\n\t\t// tags it will allow on a page\r\n\t\tif (typeof options.singleton === \"undefined\") options.singleton = isOldIE();\r\n\r\n\t\t// By default, add <style> tags to the bottom of <head>.\r\n\t\tif (typeof options.insertAt === \"undefined\") options.insertAt = \"bottom\";\r\n\r\n\t\tvar styles = listToStyles(list);\r\n\t\taddStylesToDom(styles, options);\r\n\r\n\t\treturn function update(newList) {\r\n\t\t\tvar mayRemove = [];\r\n\t\t\tfor(var i = 0; i < styles.length; i++) {\r\n\t\t\t\tvar item = styles[i];\r\n\t\t\t\tvar domStyle = stylesInDom[item.id];\r\n\t\t\t\tdomStyle.refs--;\r\n\t\t\t\tmayRemove.push(domStyle);\r\n\t\t\t}\r\n\t\t\tif(newList) {\r\n\t\t\t\tvar newStyles = listToStyles(newList);\r\n\t\t\t\taddStylesToDom(newStyles, options);\r\n\t\t\t}\r\n\t\t\tfor(var i = 0; i < mayRemove.length; i++) {\r\n\t\t\t\tvar domStyle = mayRemove[i];\r\n\t\t\t\tif(domStyle.refs === 0) {\r\n\t\t\t\t\tfor(var j = 0; j < domStyle.parts.length; j++)\r\n\t\t\t\t\t\tdomStyle.parts[j]();\r\n\t\t\t\t\tdelete stylesInDom[domStyle.id];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\r\n\tfunction addStylesToDom(styles, options) {\r\n\t\tfor(var i = 0; i < styles.length; i++) {\r\n\t\t\tvar item = styles[i];\r\n\t\t\tvar domStyle = stylesInDom[item.id];\r\n\t\t\tif(domStyle) {\r\n\t\t\t\tdomStyle.refs++;\r\n\t\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\r\n\t\t\t\t\tdomStyle.parts[j](item.parts[j]);\r\n\t\t\t\t}\r\n\t\t\t\tfor(; j < item.parts.length; j++) {\r\n\t\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tvar parts = [];\r\n\t\t\t\tfor(var j = 0; j < item.parts.length; j++) {\r\n\t\t\t\t\tparts.push(addStyle(item.parts[j], options));\r\n\t\t\t\t}\r\n\t\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction listToStyles(list) {\r\n\t\tvar styles = [];\r\n\t\tvar newStyles = {};\r\n\t\tfor(var i = 0; i < list.length; i++) {\r\n\t\t\tvar item = list[i];\r\n\t\t\tvar id = item[0];\r\n\t\t\tvar css = item[1];\r\n\t\t\tvar media = item[2];\r\n\t\t\tvar sourceMap = item[3];\r\n\t\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\r\n\t\t\tif(!newStyles[id])\r\n\t\t\t\tstyles.push(newStyles[id] = {id: id, parts: [part]});\r\n\t\t\telse\r\n\t\t\t\tnewStyles[id].parts.push(part);\r\n\t\t}\r\n\t\treturn styles;\r\n\t}\r\n\r\n\tfunction insertStyleElement(options, styleElement) {\r\n\t\tvar head = getHeadElement();\r\n\t\tvar lastStyleElementInsertedAtTop = styleElementsInsertedAtTop[styleElementsInsertedAtTop.length - 1];\r\n\t\tif (options.insertAt === \"top\") {\r\n\t\t\tif(!lastStyleElementInsertedAtTop) {\r\n\t\t\t\thead.insertBefore(styleElement, head.firstChild);\r\n\t\t\t} else if(lastStyleElementInsertedAtTop.nextSibling) {\r\n\t\t\t\thead.insertBefore(styleElement, lastStyleElementInsertedAtTop.nextSibling);\r\n\t\t\t} else {\r\n\t\t\t\thead.appendChild(styleElement);\r\n\t\t\t}\r\n\t\t\tstyleElementsInsertedAtTop.push(styleElement);\r\n\t\t} else if (options.insertAt === \"bottom\") {\r\n\t\t\thead.appendChild(styleElement);\r\n\t\t} else {\r\n\t\t\tthrow new Error(\"Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.\");\r\n\t\t}\r\n\t}\r\n\r\n\tfunction removeStyleElement(styleElement) {\r\n\t\tstyleElement.parentNode.removeChild(styleElement);\r\n\t\tvar idx = styleElementsInsertedAtTop.indexOf(styleElement);\r\n\t\tif(idx >= 0) {\r\n\t\t\tstyleElementsInsertedAtTop.splice(idx, 1);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction createStyleElement(options) {\r\n\t\tvar styleElement = document.createElement(\"style\");\r\n\t\tstyleElement.type = \"text/css\";\r\n\t\tinsertStyleElement(options, styleElement);\r\n\t\treturn styleElement;\r\n\t}\r\n\r\n\tfunction createLinkElement(options) {\r\n\t\tvar linkElement = document.createElement(\"link\");\r\n\t\tlinkElement.rel = \"stylesheet\";\r\n\t\tinsertStyleElement(options, linkElement);\r\n\t\treturn linkElement;\r\n\t}\r\n\r\n\tfunction addStyle(obj, options) {\r\n\t\tvar styleElement, update, remove;\r\n\r\n\t\tif (options.singleton) {\r\n\t\t\tvar styleIndex = singletonCounter++;\r\n\t\t\tstyleElement = singletonElement || (singletonElement = createStyleElement(options));\r\n\t\t\tupdate = applyToSingletonTag.bind(null, styleElement, styleIndex, false);\r\n\t\t\tremove = applyToSingletonTag.bind(null, styleElement, styleIndex, true);\r\n\t\t} else if(obj.sourceMap &&\r\n\t\t\ttypeof URL === \"function\" &&\r\n\t\t\ttypeof URL.createObjectURL === \"function\" &&\r\n\t\t\ttypeof URL.revokeObjectURL === \"function\" &&\r\n\t\t\ttypeof Blob === \"function\" &&\r\n\t\t\ttypeof btoa === \"function\") {\r\n\t\t\tstyleElement = createLinkElement(options);\r\n\t\t\tupdate = updateLink.bind(null, styleElement);\r\n\t\t\tremove = function() {\r\n\t\t\t\tremoveStyleElement(styleElement);\r\n\t\t\t\tif(styleElement.href)\r\n\t\t\t\t\tURL.revokeObjectURL(styleElement.href);\r\n\t\t\t};\r\n\t\t} else {\r\n\t\t\tstyleElement = createStyleElement(options);\r\n\t\t\tupdate = applyToTag.bind(null, styleElement);\r\n\t\t\tremove = function() {\r\n\t\t\t\tremoveStyleElement(styleElement);\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tupdate(obj);\r\n\r\n\t\treturn function updateStyle(newObj) {\r\n\t\t\tif(newObj) {\r\n\t\t\t\tif(newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap)\r\n\t\t\t\t\treturn;\r\n\t\t\t\tupdate(obj = newObj);\r\n\t\t\t} else {\r\n\t\t\t\tremove();\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\r\n\tvar replaceText = (function () {\r\n\t\tvar textStore = [];\r\n\r\n\t\treturn function (index, replacement) {\r\n\t\t\ttextStore[index] = replacement;\r\n\t\t\treturn textStore.filter(Boolean).join('\\n');\r\n\t\t};\r\n\t})();\r\n\r\n\tfunction applyToSingletonTag(styleElement, index, remove, obj) {\r\n\t\tvar css = remove ? \"\" : obj.css;\r\n\r\n\t\tif (styleElement.styleSheet) {\r\n\t\t\tstyleElement.styleSheet.cssText = replaceText(index, css);\r\n\t\t} else {\r\n\t\t\tvar cssNode = document.createTextNode(css);\r\n\t\t\tvar childNodes = styleElement.childNodes;\r\n\t\t\tif (childNodes[index]) styleElement.removeChild(childNodes[index]);\r\n\t\t\tif (childNodes.length) {\r\n\t\t\t\tstyleElement.insertBefore(cssNode, childNodes[index]);\r\n\t\t\t} else {\r\n\t\t\t\tstyleElement.appendChild(cssNode);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction applyToTag(styleElement, obj) {\r\n\t\tvar css = obj.css;\r\n\t\tvar media = obj.media;\r\n\t\tvar sourceMap = obj.sourceMap;\r\n\r\n\t\tif(media) {\r\n\t\t\tstyleElement.setAttribute(\"media\", media)\r\n\t\t}\r\n\r\n\t\tif(styleElement.styleSheet) {\r\n\t\t\tstyleElement.styleSheet.cssText = css;\r\n\t\t} else {\r\n\t\t\twhile(styleElement.firstChild) {\r\n\t\t\t\tstyleElement.removeChild(styleElement.firstChild);\r\n\t\t\t}\r\n\t\t\tstyleElement.appendChild(document.createTextNode(css));\r\n\t\t}\r\n\t}\r\n\r\n\tfunction updateLink(linkElement, obj) {\r\n\t\tvar css = obj.css;\r\n\t\tvar media = obj.media;\r\n\t\tvar sourceMap = obj.sourceMap;\r\n\r\n\t\tif(sourceMap) {\r\n\t\t\t// http://stackoverflow.com/a/26603875\r\n\t\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\r\n\t\t}\r\n\r\n\t\tvar blob = new Blob([css], { type: \"text/css\" });\r\n\r\n\t\tvar oldSrc = linkElement.href;\r\n\r\n\t\tlinkElement.href = URL.createObjectURL(blob);\r\n\r\n\t\tif(oldSrc)\r\n\t\t\tURL.revokeObjectURL(oldSrc);\r\n\t}\r\n\n\n/***/ }\n/******/ ])\n});\n;"],"sourceRoot":"/source/"}